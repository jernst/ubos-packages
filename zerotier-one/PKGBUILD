developer=http://zerotier.com/
url=${developer}
maintainer=http://indiecomputing.com/
pkgname=$(basename $(pwd))
pkgver=1.1.12
pkgrel=1
pkgdesc='ZeroTier is a software defined networking layer for Earth.'
arch=('x86_64' 'armv6h' 'armv7h')
url=http://zerotier.com/
license=('GPL')
install=${pkgname}.install
source=(
    ${pkgname}-${pkgver}::https://github.com/zerotier/ZeroTierOne/archive/${pkgver}.tar.gz
    ${pkgname}.install
)
makedepends=(
    npm
)
sha512sums=('40cec8164b62a128d9421f75bc52819c2d07d898c8a758fc9864c49c96acfa6c8b8c9453dbfa3b94a2fb3574b2a38ca7f99b792d5515666dd59f4c08270d6d3b'
            '940c260d59728dc6487c8f56d67d926cc78f12394e68aa7c1a54c51f4e243806367f6cbcf14b19cb1e0df1dd5ca78a6afd301ebdb51bee2e66734e1fb9d1f764')

build() {
    cd "${srcdir}/ZeroTierOne-${pkgver}"
    make
}

package() {
    mkdir -p ${pkgdir}/usr/bin
    install -m0755 "${srcdir}/ZeroTierOne-${pkgver}/zerotier-one" "${pkgdir}/usr/bin/"
    ln -s zerotier-one "${pkgdir}/usr/bin/zerotier-cli"
    ln -s zerotier-one "${pkgdir}/usr/bin/zerotier-idtool"

    mkdir -p ${pkgdir}/usr/lib/systemd/system/
    install -m644 "${startdir}/zerotier-one.service" "${pkgdir}/usr/lib/systemd/system"

    mkdir -p ${pkgdir}/var/lib/zerotier-one   
}
